---
include:
  - project: "univention/customers/dataport/upx/common-ci"
    ref: "aniemann/helm-sign-charts-337"
    file:
      - "defaults/stages.yaml"
      - "jobs/lint-pre-commit.yaml"
      - "jobs/lint-commit-messages.yaml"
      - "jobs/lint-pre-commit.yaml"
      - "jobs/semantic-release-env.yaml"
      # - "jobs/container-build-souvap.yaml"
      - "jobs/package-and-publish-helm-charts.yaml"
      - "jobs/package-and-publish-helm-charts-souvap.yaml"
      - "defaults/souvap-workflow.yaml"
      - "templates/souvap.yaml"
# .build-matrix: &build-matrix
#   - IMAGE_NAME: "listener-base"
#     KANIKO_ARGS: "--target=final"
#   - IMAGE_NAME: "listener-base-debug"
#     KANIKO_ARGS: "--target=debug"
#
# container-build:
#   parallel:
#     matrix: *build-matrix
#   variables:
#     KANIKO_BUILD_CONTEXT: "${CI_PROJECT_DIR}"
#     DOCKERFILE_PATH: "docker/listener-base/Dockerfile"
#
# container-generate-sbom:
#   parallel:
#     matrix: *build-matrix
#
# container-sign:
#   parallel:
#     matrix: *build-matrix
#
# container-security-scan:
#   parallel:
#     matrix: *build-matrix
#
# push-image-souvap:
#   parallel:
#     matrix: *build-matrix
#
# container-sign-souvap:
#   parallel:
#     matrix: *build-matrix

package-helm-charts:
  variables:
    IMAGE_HELM: "gitregistry.knut.univention.de/univention/customers/dataport/upx/common-ci/helm:1.11.2-pre-aniemann-helm-sign-charts-337"
publish-helm-charts-locally-oci:
  variables:
    IMAGE_HELM: "gitregistry.knut.univention.de/univention/customers/dataport/upx/common-ci/helm:1.11.2-pre-aniemann-helm-sign-charts-337"
publish-helm-charts-oci-souvap:
  variables:
    IMAGE_HELM: "gitregistry.knut.univention.de/univention/customers/dataport/upx/common-ci/helm:1.11.2-pre-aniemann-helm-sign-charts-337"
...
